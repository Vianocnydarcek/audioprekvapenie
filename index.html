<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Je≈æi≈°kov ≈æiv√Ω Robo-pes</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --dog-color: #d1d8e0;
            --dog-dark: #a5b1c2;
            --accent: #45aaf2;
            --gold: #f7b731;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: #1e272e;
            color: white; margin: 0; padding: 10px;
            display: flex; flex-direction: column; align-items: center; min-height: 100vh;
            touch-action: none; /* Zabr√°ni scrolovaniu pri hran√≠ */
            overflow: hidden;
        }

        .app-container {
            background: rgba(255, 255, 255, 0.98); border-radius: 40px;
            max-width: 450px; width: 95%; padding: 20px; color: #333;
            box-shadow: 0 0 40px rgba(255,255,255,0.2); text-align: center; margin-top: 10px;
            position: relative; z-index: 10;
        }

        /* --- ≈ΩIV√ù ROBO-PES --- */
        .game-area { height: 260px; position: relative; width: 100%; overflow: hidden; touch-action: none; }
        
        .dog-wrapper { 
            height: 200px; position: absolute; width: 180px; 
            left: 50%; top: 50%; transform: translate(-50%, -40%);
            transition: transform 0.1s;
        }

        .dog-body { 
            width: 110px; height: 85px; background: var(--dog-color); 
            border-radius: 40px; position: absolute; bottom: 20px; left: 35px;
            border: 3px solid var(--dog-dark); animation: breathe 3s infinite ease-in-out;
        }
        
        .dog-head {
            width: 85px; height: 75px; background: var(--dog-color);
            border-radius: 25px; position: absolute; top: 10px; right: 20px;
            border: 3px solid var(--dog-dark); z-index: 5;
        }

        .ear { width: 25px; height: 45px; background: var(--dog-dark); position: absolute; border-radius: 10px; top: -10px; }
        .ear.l { left: 5px; transform: rotate(-15deg); }
        .ear.r { right: 5px; transform: rotate(15deg); }

        .eye { 
            width: 14px; height: 14px; background: #222; border-radius: 50%;
            position: absolute; top: 22px; border: 2px solid var(--accent);
            box-shadow: 0 0 8px var(--accent);
        }
        .eye.l { left: 15px; } .eye.r { right: 18px; }

        .tail {
            width: 45px; height: 12px; background: var(--dog-dark);
            position: absolute; left: 10px; bottom: 70px; border-radius: 10px;
            transform-origin: right; animation: wag 0.8s infinite alternate;
        }
        .tail.fast { animation: wag 0.2s infinite alternate !important; }

        /* --- INTERAKT√çVNA KOS≈§ --- */
        #bone {
            font-size: 40px; position: absolute; bottom: 20px; right: 20px;
            cursor: grab; z-index: 100; touch-action: none; user-select: none;
        }

        /* --- ANIM√ÅCIE --- */
        @keyframes wag { from { transform: rotate(10deg); } to { transform: rotate(50deg); } }
        @keyframes breathe { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.03); } }
        
        .heart {
            position: absolute; font-size: 20px; color: #ff4757;
            pointer-events: none; animation: floatUp 1s forwards; z-index: 99;
        }
        @keyframes floatUp {
            0% { transform: translateY(0) opacity(1); }
            100% { transform: translateY(-100px) opacity(0); }
        }

        /* --- OSTATN√â PRVKY --- */
        .speech-bubble { background: #f1f2f6; border-radius: 20px; padding: 12px; margin: 10px 0; font-weight: bold; border: 2px solid #ddd; font-size: 14px; }
        .progress-bg { background: #eee; height: 15px; border-radius: 10px; overflow: hidden; margin: 10px 0; }
        .progress-fill { background: linear-gradient(90deg, #2ecc71, #27ae60); width: 0%; height: 100%; transition: width 0.3s; }
        
        .book-card { background: white; border: 2px solid #eee; border-radius: 15px; padding: 12px; margin: 8px 0; display: none; cursor: pointer; text-align: left; }
        .btn { background: var(--accent); color: white; border: none; padding: 12px 20px; border-radius: 25px; cursor: pointer; font-weight: bold; margin: 5px; }
        #voucher-section { display: none; background: #fff9c4; border: 3px dashed var(--gold); padding: 15px; border-radius: 20px; }
    </style>
</head>
<body>

    <div class="app-container">
        <div class="game-area" id="game-area">
            <div id="bone">ü¶¥</div>
            <div class="dog-wrapper" id="dog-wrapper">
                <div class="tail" id="tail"></div>
                <div class="dog-body" id="dog-touch-area"></div>
                <div class="dog-head">
                    <div class="ear l"></div><div class="ear r"></div>
                    <div class="eye l"></div><div class="eye r"></div>
                </div>
            </div>
        </div>

        <div class="speech-bubble" id="dialogue">ƒåak√°m na teba, Zoe...</div>

        <div id="phase-name">
            <input type="text" id="dog-name-input" placeholder="Ako sa budem vola≈•?" style="padding:10px; border-radius:15px; border:1px solid #ccc; width:60%;">
            <button class="btn" onclick="nameDog()">To je tvoje meno!</button>
        </div>

        <div id="phase-play" style="display:none;">
            <div style="font-size: 12px; color: #666;">Hladkaj ma alebo ma nak≈ïm kos≈•ou!</div>
            <div class="progress-bg"><div id="happy-bar" class="progress-fill"></div></div>
        </div>

        <div id="phase-books">
            <div class="book-card" onclick="bookTalk(1)">üèùÔ∏è <strong>Spr√°vna pƒõtka</strong></div>
            <div class="book-card" onclick="bookTalk(2)">üêï <strong>O chlapcovi, ktor√Ω rozumel psom</strong></div>
            <div class="book-card" onclick="bookTalk(3)">üöÄ <strong>Robopes</strong></div>
            <button class="btn" id="btn-reveal" style="display:none; background:var(--gold); color:black;" onclick="showFinal()">üéÅ ODOMKN√ö≈§ DARƒåEK OD JE≈ΩI≈†KA</button>
        </div>

        <div id="voucher-section">
            <h3 style="margin:0;">üéÑ Tvoj k√≥d üéÑ</h3>
            <p style="font-size: 22px; font-weight: bold; margin:10px 0;">EECHPLKMKBHH</p>
            <a href="https://www.audiolibrix.com/sk/User/Register?returnUrl=%2Fsk" target="_blank" style="text-decoration:none;">
                <button class="btn" style="width:100%; background:#e74c3c;">ZAREGISTROVA≈§ SA</button>
            </a>
        </div>
    </div>

    <script>
        let happiness = 0;
        let dogName = "";
        let isNamingDone = false;
        const nameZoe = "Zoe";

        function speak(text) {
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(text);
            msg.lang = 'sk-SK';
            msg.pitch = 1.4;
            document.getElementById('dialogue').innerText = text;
            window.speechSynthesis.speak(msg);
        }

        // --- HLADKANIE (TOUCH/MOUSE) ---
        const dogArea = document.getElementById('game-area');
        dogArea.addEventListener('mousemove', (e) => handlePet(e.clientX, e.clientY));
        dogArea.addEventListener('touchmove', (e) => {
            handlePet(e.touches[0].clientX, e.touches[0].clientY);
        });

        function handlePet(x, y) {
            if(!isNamingDone || happiness >= 100) return;
            
            const dogRect = document.getElementById('dog-touch-area').getBoundingClientRect();
            if(x > dogRect.left && x < dogRect.right && y > dogRect.top && y < dogRect.bottom) {
                spawnHeart(x, y);
                increaseHappiness(0.5);
                document.getElementById('tail').classList.add('fast');
                if(Math.random() > 0.95) speak("To je tak pr√≠jemn√©!");
            } else {
                document.getElementById('tail').classList.remove('fast');
            }
        }

        function spawnHeart(x, y) {
            const h = document.createElement('div');
            h.innerHTML = "‚ù§Ô∏è";
            h.className = "heart";
            h.style.left = (x - 10) + "px";
            h.style.top = (y - 10) + "px";
            document.body.appendChild(h);
            setTimeout(() => h.remove(), 1000);
        }

        // --- K≈îMENIE (DRAG BONE) ---
        const bone = document.getElementById('bone');
        let isDragging = false;

        bone.onpointerdown = (e) => { isDragging = true; bone.setPointerCapture(e.pointerId); };
        bone.onpointermove = (e) => {
            if (!isDragging) return;
            bone.style.left = (e.clientX - 20) + "px";
            bone.style.top = (e.clientY - 20) + "px";
            
            const dogRect = document.getElementById('dog-touch-area').getBoundingClientRect();
            if(e.clientX > dogRect.left && e.clientX < dogRect.right && e.clientY > dogRect.top && e.clientY < dogRect.bottom) {
                eatBone();
            }
        };
        bone.onpointerup = () => isDragging = false;

        function eatBone() {
            isDragging = false;
            bone.style.display = "none";
            increaseHappiness(30);
            speak("M≈àam! Je≈æi≈°ko vie, ƒço mi chut√≠. ƒéakujem, " + nameZoe + "!");
            confetti({ particleCount: 50, colors: ['#f7b731', '#ffffff'] });
            setTimeout(() => { bone.style.display = "block"; bone.style.bottom = "20px"; bone.style.right = "20px"; bone.style.left = "auto"; bone.style.top = "auto"; }, 3000);
        }

        // --- LOGIKA HRY ---
        function nameDog() {
            const input = document.getElementById('dog-name-input').value;
            if(!input) return;
            dogName = input;
            isNamingDone = true;
            document.getElementById('phase-name').style.display = 'none';
            document.getElementById('phase-play').style.display = 'block';
            speak("Ahoj " + nameZoe + "! Odteraz som tvoj " + dogName + ". Uk√°≈æe≈° mi, ako ma vie≈° pohladka≈•?");
        }

        function increaseHappiness(amt) {
            happiness += amt;
            if(happiness > 100) happiness = 100;
            document.getElementById('happy-bar').style.width = happiness + "%";
            
            if(happiness >= 100 && isNamingDone) {
                finishPlaying();
            }
        }

        function finishPlaying() {
            happiness = 101; // Zastavi≈• ƒèal≈°ie zvy≈°ovanie
            speak("C√≠tim sa skvele! Si super kamo≈°ka. " + nameZoe + ", Je≈æi≈°ko mi dal za √∫lohu uk√°za≈• ti tvoj darƒçek. Pozri na tieto rozpr√°vky!");
            document.getElementById('phase-play').style.display = 'none';
            document.querySelectorAll('.book-card').forEach(b => b.style.display = 'block');
        }

        function bookTalk(id) {
            if(id === 1) speak("Spr√°vna pƒõtka je super! Deti a pes Tim rie≈°ia z√°hady. To by n√°s bavilo!");
            if(id === 2) speak("Tento chlapec rozumie psom. Mo≈æno by nauƒçil rozumie≈• aj teba, ƒço ti hovor√≠m!");
            if(id === 3) speak("M√¥j kamo≈° Robopes! Je s n√≠m veƒæk√° sranda, sk√∫s si ho vypoƒçu≈•.");
            document.getElementById('btn-reveal').style.display = 'block';
        }

        function showFinal() {
            document.getElementById('phase-books').style.display = 'none';
            document.getElementById('voucher-section').style.display = 'block';
            speak("≈†≈•astn√© a vesel√© Vianoce, Zoe! Tu je tvoj k√≥d do sveta rozpr√°vok.");
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
        }

        window.onload = () => {
            setTimeout(() => {
                speak("Ahoj Zoe! Je≈æi≈°ko mi o tebe rozpr√°val. Dal mi d√¥le≈æit√∫ √∫lohu, ale najprv mi mus√≠≈° vybra≈• meno.");
            }, 1000);
        };
    </script>
</body>
</html>
