<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Je≈æi≈°kov Robo-posol pre Zoe</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --metal: #d1d8e0; --glow: #00d2ff; --gold: #f1c40f; }
        body {
            font-family: 'Segoe UI', sans-serif; background: radial-gradient(circle, #2c3e50, #000);
            color: white; margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; 
            min-height: 100vh; touch-action: none; overflow: hidden;
        }
        .container {
            background: rgba(255, 255, 255, 0.98); border-radius: 40px; max-width: 450px; width: 95%; 
            padding: 20px; color: #333; box-shadow: 0 0 50px rgba(0, 210, 255, 0.3); text-align: center; margin-top: 10px;
        }
        
        /* --- GRAFIKA PSA (SVG) --- */
        #dog-container { width: 100%; height: 250px; position: relative; cursor: pointer; touch-action: none; }
        .heart { position: absolute; font-size: 25px; pointer-events: none; animation: floatUp 1s forwards; z-index: 100; }
        @keyframes floatUp { 0% { transform: translateY(0) opacity(1); } 100% { transform: translateY(-100px) opacity(0); } }
        
        #bone { font-size: 50px; position: absolute; bottom: 10px; right: 10px; cursor: grab; z-index: 110; touch-action: none; user-select: none; }

        /* --- UI --- */
        .speech { background: #f1f2f6; border-radius: 20px; padding: 15px; margin: 15px 0; font-weight: bold; border: 2px solid #ddd; font-size: 15px; min-height: 50px; }
        .progress-bg { background: #eee; height: 18px; border-radius: 10px; overflow: hidden; margin: 10px 0; display: none; }
        .progress-fill { background: linear-gradient(90deg, #2ecc71, #27ae60); width: 0%; height: 100%; transition: width 0.3s; }
        .btn { background: #3498db; color: white; border: none; padding: 15px 25px; border-radius: 30px; cursor: pointer; font-weight: bold; font-size: 16px; margin: 10px 0; }
        .book-card { background: white; border: 2px solid #eee; border-radius: 15px; padding: 12px; margin: 8px 0; display: none; cursor: pointer; text-align: left; }
        #voucher-section { display: none; background: #fff9c4; border: 3px dashed var(--gold); padding: 20px; border-radius: 25px; }
    </style>
</head>
<body>

<div class="container">
    <div id="dog-container">
        <svg viewBox="0 0 200 200" id="robo-dog-svg" style="width: 100%; height: 100%;">
            <defs>
                <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:#f5f6fa;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#7f8c8d;stop-opacity:1" />
                </linearGradient>
            </defs>
            <rect x="60" y="100" width="80" height="60" rx="30" fill="url(#grad1)" stroke="#2c3e50" stroke-width="2" />
            <path id="tail" d="M 60 130 Q 30 130 20 100" fill="none" stroke="#7f8c8d" stroke-width="6" stroke-linecap="round">
                <animateTransform attributeName="transform" type="rotate" from="0 60 130" to="20 60 130" dur="0.5s" repeatCount="indefinite" />
            </path>
            <rect x="90" y="40" width="70" height="70" rx="20" fill="url(#grad1)" stroke="#2c3e50" stroke-width="2" />
            <path d="M 100 40 L 85 10 L 115 40 Z" fill="#7f8c8d" />
            <path d="M 150 40 L 165 10 L 135 40 Z" fill="#7f8c8d" />
            <rect x="105" y="60" width="12" height="12" rx="2" fill="#00d2ff" id="eye-l">
                <animate attributeName="opacity" values="1;0.2;1" dur="4s" repeatCount="indefinite" />
            </rect>
            <rect x="143" y="60" width="12" height="12" rx="2" fill="#00d2ff" id="eye-r">
                <animate attributeName="opacity" values="1;0.2;1" dur="4s" repeatCount="indefinite" />
            </rect>
            <circle cx="150" cy="90" r="5" fill="#2c3e50" />
            <path d="M 140 100 Q 150 105 160 100" fill="none" stroke="#2c3e50" stroke-width="2" />
            <circle cx="75" cy="115" r="8" fill="#95a5a6" stroke="#2c3e50" />
            <circle cx="125" cy="115" r="8" fill="#95a5a6" stroke="#2c3e50" />
        </svg>
        <div id="bone" style="display:none;">ü¶¥</div>
    </div>

    <div class="speech" id="dialogue">Pripravujem Je≈æi≈°kov odkaz...</div>

    <div id="p1">
        <input type="text" id="d-name" placeholder="Daj mi meno..." style="padding:12px; border-radius:15px; border:1px solid #ccc; width:60%; font-size:16px;">
        <button class="btn" onclick="init()">OK</button>
    </div>

    <div id="p2" class="progress-bg"><div id="bar" class="progress-fill"></div></div>

    <div id="p3">
        <div class="book-card" onclick="bt(1)">üèùÔ∏è <strong>Spr√°vna pƒõtka</strong></div>
        <div class="book-card" onclick="bt(2)">üêï <strong>O chlapcovi, ktor√Ω rozumel psom</strong></div>
        <div class="book-card" onclick="bt(3)">üöÄ <strong>Robopes</strong></div>
        <button class="btn" id="gift-btn" style="display:none; background:var(--gold); color:black;" onclick="showF()">üéÅ UK√Å≈Ω MI DARƒåEK</button>
    </div>

    <div id="voucher-section">
        <h3 style="margin:0;">üéÑ Odkaz od Je≈æi≈°ka üéÑ</h3>
        <p style="font-size: 24px; font-weight: bold; margin:10px 0;">EECHPLKMKBHH</p>
        <a href="https://www.audiolibrix.com/sk/User/Register?returnUrl=%2Fsk" target="_blank" style="text-decoration:none;">
            <button class="btn" style="width:100%; background:#e74c3c;">OTVORI≈§ KNI≈ΩNICU</button>
        </a>
    </div>
</div>

<script>
    let happy = 0; let dName = ""; let stage = 0;
    const speech = document.getElementById('dialogue');

    function talk(t) {
        window.speechSynthesis.cancel();
        const m = new SpeechSynthesisUtterance(t);
        m.lang = 'sk-SK'; m.pitch = 1.3;
        speech.innerText = t;
        window.speechSynthesis.speak(m);
    }

    function init() {
        const val = document.getElementById('d-name').value;
        if(!val) return;
        dName = val; stage = 1;
        document.getElementById('p1').style.display = 'none';
        document.getElementById('p2').style.display = 'block';
        document.getElementById('bone').style.display = 'block';
        talk("Ahoj Zoe! Tak≈æe ja som " + dName + ". Je≈æi≈°ko ƒç√≠tal tvoj list a poslal ma za tebou. Ale po tej ceste z neba som tak√Ω unaven√Ω... rozvesel√≠≈° ma? Sk√∫s ma pohladi≈• prstom alebo mi daj kostiƒçku!");
    }

    // Interactive Petting
    const container = document.getElementById('dog-container');
    container.addEventListener('mousemove', (e) => pet(e.clientX, e.clientY));
    container.addEventListener('touchmove', (e) => pet(e.touches[0].clientX, e.touches[0].clientY));

    function pet(x, y) {
        if(stage !== 1) return;
        const r = container.getBoundingClientRect();
        if(x > r.left && x < r.right && y > r.top && y < r.bottom) {
            happy += 0.5; updateBar();
            if(Math.random() > 0.9) heart(x, y);
        }
    }

    function heart(x, y) {
        const h = document.createElement('div');
        h.innerHTML = "‚ù§Ô∏è"; h.className = "heart";
        h.style.left = (x - r.left) + "px"; h.style.top = (y - r.top) + "px";
        container.appendChild(h);
        setTimeout(() => h.remove(), 1000);
    }

    // Bone Interaction
    const bone = document.getElementById('bone'); let dragging = false;
    bone.onpointerdown = (e) => { dragging = true; bone.setPointerCapture(e.pointerId); };
    bone.onpointermove = (e) => {
        if(!dragging) return;
        bone.style.left = (e.clientX - 25) + "px"; bone.style.top = (e.clientY - 25) + "px";
        const r = container.getBoundingClientRect();
        if(e.clientX > r.left && e.clientX < r.right && e.clientY > r.top && e.clientY < r.bottom) {
            dragging = false; bone.style.display = "none";
            happy += 30; updateBar();
            talk("M≈àam! To je dobrota! U≈æ mi je oveƒæa lep≈°ie.");
            confetti({particleCount: 30, origin:{x:0.5, y:0.4}});
            setTimeout(() => { bone.style.display="block"; bone.style.bottom="10px"; bone.style.right="10px"; bone.style.left="auto"; bone.style.top="auto";}, 2000);
        }
    };
    bone.onpointerup = () => dragging = false;

    function updateBar() {
        if(stage !== 1) return;
        document.getElementById('bar').style.width = Math.min(happy, 100) + "%";
        if(happy >= 100) {
            stage = 2;
            document.getElementById('p2').style.display = 'none';
            document.getElementById('bone').style.display = 'none';
            talk("Vau, Zoe! C√≠tim sa √∫≈æasne! Vie≈° ƒço? Je≈æi≈°ko mi pre teba nieƒço nechal. S√∫ to audioknihy pln√© rozpr√°vok. Uk√°≈æem ti moje najobƒæ√∫benej≈°ie!");
            setTimeout(() => {
                document.querySelectorAll('.book-card').forEach(c => c.style.display = 'block');
            }, 3000);
        }
    }

    function bt(id) {
        confetti({particleCount: 20});
        if(id === 1) talk("Spr√°vna pƒõtka! Je to o partii det√≠ a ich psovi Timovi. Budete spolu hƒæada≈• poklad na ostrove!");
        if(id === 2) talk("Tento pr√≠beh je o chlapcovi, ktor√Ω rozumie psom √∫plne tak, ako ty mne. Je to veƒæmi mil√©.");
        if(id === 3) talk("Robopes! To je o mojom kamo≈°ovi, ktor√Ω je cel√Ω zo ≈æeleza a rob√≠ poriadne bl√°znovstv√°.");
        document.getElementById('gift-btn').style.display = 'block';
    }

    function showF() {
        document.getElementById('p3').style.display = 'none';
        document.getElementById('voucher-section').style.display = 'block';
        talk("≈†≈•astn√© a vesel√© Vianoce, Zoe! Tu je tvoj tajn√Ω k√≥d. U≈æ√≠vaj si v≈°etky tie kr√°sne pr√≠behy!");
        confetti({particleCount: 150, spread: 70, origin: {y: 0.6}});
    }

    window.onload = () => {
        setTimeout(() => talk("Ahoj Zoe! Je≈æi≈°ko mi o tebe rozpr√°val a ƒç√≠tal tvoj list. Poslal ma za tebou s nieƒç√≠m ≈°peci√°lnym. Ale najsk√¥r... ako ma pomenuje≈°?"), 1000);
    };
</script>

</body>
</html>
